---
sidebar_position: 10
---

# 角色

Warudo 原生支持导入 [VRM 格式](https://vrm.dev/en/univrm/)的角色模型。如果你的模型格式不是 VRM（例如是 MMD 或者 VRChat 专用的模型），可以使用 [Mod SDK](https://tiger-tang.gitbook.io/warudo/advanced/sdk) 导出为 `.warudo` 格式，即可加载到 Warudo 中。

默认情况下，角色文件应放在 Warudo 数据文件夹的 `Characters` 子文件夹内。

:::info
找不到数据文件夹？点击「🚀」->「打开数据文件夹」即可。
:::

## 属性

* 源：模型文件的路径。

### 动作捕捉

详情请参考[动作捕捉方案](mocap/overview.md)页面。

* 配置动作捕捉：选择 [面部追踪](../../mocap/face-tracking.md) 及 [姿态追踪](../../mocap/body-tracking.md) 模板，自动生成相应的资源和 [蓝图](https://tiger-tang.gitbook.io/warudo/advanced/blueprints) 。
* 移除动作捕捉：移除此前配置动作捕捉时自动生成的资源和蓝图。

### 表情

详情请参考 [表情](blendshape-expression.md) 子页面。

### 动画

* 保存动画预设：保存下列动画选项为预设。预设可以应用到任何场景的任何角色。
* 加载动画预设：加载已有的动画预设。以下的动画选项将被覆盖。
* 待机动画：模型默认播放的动画。

:::tip
**Warudo 内置了**[**超过 500 个待机动画**](../../misc/idle-animations.md)，请务必尝试看看！
:::

部分姿态追踪模板（例：MediaPipe, RhyLive）**支持将动捕数据与待机动画融合**，实现如下效果：

<div className="video-box"><video controls src="https://user-images.githubusercontent.com/3406505/180953465-7b91a347-452d-4c03-b860-45dc58ec0392.mp4" />
这里上半身的弯腰实际是待机动画，而头部和双手的动作则为动作捕捉。当丢失双手动捕时，双手会平滑地切回到待机动画下的状态。
</div>

* 叠加动画：在待机动画之上叠加的动画。每一层动画可以单独设置遮罩和权重，实现身体的不同部位播放不同的动画。在列表中越靠后（下）的动画层，优先级越高。
  * 列表元素：
    * 启用：设置为「否」时，此动画层将被无视。
    * 动画：此动画层叠加的动画。
    * 权重：叠加动画的权重，即模型根据动画移动的幅度。
    * 速度：叠加动画的播放速度。注意 Warudo 的大部分内置角色动画为静态姿势 / 只有一帧，故此参数可能无效。
    * 遮罩：是否开启动画遮罩。设置为「否」时，此动画将会应用到模型的全身。
    * 遮罩身体部分：动画遮罩开启时，动画将会应用到模型的这些身体部分。
    * 遮罩上半身：快捷设置遮罩为上半身的身体部分。
    * 遮罩下半身：快捷设置遮罩为下半身的身体部分。
    * 附加动画：附加动画（additive animation）是在现有动画的基础上进行混合，而不会取代现有动画。Warudo 内置的角色动画均为非附加动画。如果你确定选择的动画为附加动画，请设置为「是」。

<div className="video-box">
<iframe class="bilibili-video" src="//player.bilibili.com/player.html?aid=985941728&bvid=BV1Zt4y1c7Re&cid=843191749&p=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true"></iframe>
叠加动画的功能演示。链接：https://www.bilibili.com/video/BV1Zt4y1c7Re
</div>

:::tip
善用叠加动画和以下的 IK 功能，可以让角色摆出几乎任何想要的姿势！
:::

* 覆盖手势：覆盖模型手部的姿势，比如摆出「✌」的手势。
  * 左手 / 右手：
    * 姿势：这只手要摆出的姿势。
    * 权重：姿势的权重，即模型手部根据姿势移动的幅度。

:::info
在内置的[动作捕捉模板](./#dong-zuo-bu-zhuo)中，待机动画、叠加动画、覆盖手势设置和[身体 IK](./#shen-ti-ik) 的优先度**均比动捕数据要低**。

也就是说，即使设置了覆盖手势，如果动捕到了左右手的数据，那么模型依然会优先采用动捕的数据；直到左右手的动捕丢失，才会平滑过渡到覆盖手势。
:::

* 呼吸动画：上半身规律性的前后摆动。
* 晃动动画：身体各部位自然的来回摇动。
* 叠加动画过渡时长：叠加动画和覆盖手势的设置被更改时，模型过渡到新设置的时长。
* 额外骨骼偏移：如果你想让头（或者身体的任何关节）永远往一边歪几十度，可以用这个。
  * 列表元素：
    * 骨骼：要偏移的骨骼。
    * 旋转偏移：骨骼在 X、Y、Z 轴上旋转的角度。

### 视线 IK

:::tip
**IK 是什么？**IK 是 Inverse Kinematics（反向运动学）的简称，在游戏引擎以及 Warudo 中，IK 可理解为「让模型的某个身体部位试图朝向 / 够到某个空间中的位置」，无需事先由动画师制作骨骼动画。如下所示：

![](/doc-img/zh-assets-character.gif)
<p class="img-desc">来源：https://medium.com/unity3danimation/overview-of-inverse-kinematics-9769a43ba956</p>
:::

让角色望向场景内的指定目标（例如摄像机）。

* 目标：要望向的目标。必须是场景里的实体，比如[摄像机](../camera.md)、[道具](../prop.md)、[锚点](../anchor.md)等。
* 整体权重：为 0 时，角色望向原本方向。为 1 时，角色望向指定目标。
* 眼睛权重：眼睛望向指定目标的权重。
* 头部权重：头部转向指定目标的权重。
* 身体权重：身体转向指定目标的权重。
* 固定眼睛权重：越大，眼睛的移动范围越小。
* 固定头部权重：越大，头部的旋转范围越小。
* 固定身体权重：越大，身体的旋转范围越小。

### 身体 IK

让角色的脊椎或者四肢跟随场景内的指定目标。

* IK 目标：此身体部位要跟随的目标。必须是场景里的实体，比如[摄像机](../camera.md)、[道具](../prop.md)、[锚点](../anchor.md)等。
* （未创建临时锚点前）在当前位置创建临时 IK 目标锚点：在此身体部位的当前位置，创建一个临时的[锚点](../anchor.md)资源，把 IK 目标设置为这个锚点，并逐渐淡入 IK。
* （创建临时锚点后）移除临时 IK 目标锚点：移除给此身体部位创建的临时锚点资源，并逐渐淡出 IK。

:::tip
创建临时锚点可以方便地将模型的双手「固定」在空间的理想位置，防止出现因为动捕而双手左右飘的情况，对于一些特定姿势非常实用。

<div className="video-box"><video controls src="https://user-images.githubusercontent.com/3406505/196039288-aac4e485-c9f9-4686-948e-75f783586b25.mp4" />
创建锚点前
</div>

<div className="video-box"><video controls src="https://user-images.githubusercontent.com/3406505/196039290-13b91459-110d-4706-9c77-3516b1c3b175.mp4" />
创建锚点后
</div>
:::

* 位置权重：为 0 时，身体部位保留在原本位置；为 1 时，此身体部位将被全力「拉向」目标。
* 旋转权重：与位置权重类似，但决定身体部位的旋转是否也跟随目标。
* 肘部目标：肘部（腿的话则是膝盖位置）要跟随的指定目标。


![](/doc-img/zh-assets-character-2.webp)

* 肘部目标权重：为 0 时，肘部位置不设限制；为 1 时，肘部位置将被全力「拉向」肘部目标。

### 布娃娃

:::caution
实验功能，暂时不推荐启用。
:::

### 网格

模型的网格（Mesh）或蒙皮网格（Skinned Mesh）信息。

* 列表元素：
  * 显示：是否显示此网格。

:::info
[VRoid Studio](https://vroid.com/en/studio) 导出的模型只有身体 `Body` 和脸部 `Face` 两个网格。更为精细的模型可能会将角色的衣服、配饰、尾巴、兽耳等拆分为单独的网格。
:::

## 示例

### 模型现在的姿势太阳刚了 / 太娇柔了 / 手臂陷进身体里了 / 手臂离身体太远了。

可以设置**额外骨骼偏移**。肩膀两个关节的旋转角度其实意外地影响对角色性格的观感哦！

![](/doc-img/zh-assets-character-3.webp)

### 我想设置切换网格（衣服、配饰……）的快捷键。

创建一个新蓝图（或者打开现有的蓝图），如下设置即可：

![](/doc-img/zh-assets-character-4.webp)

### 我想设置切换待机动画的快捷键。

创建一个新蓝图（或者打开现有的蓝图），如下设置即可：

![](/doc-img/zh-assets-character-5.webp)

### 我设置好了角色的待机动画，但我想微调姿势。/ 我设置好了角色的待机动画，但我想固定住双手，不会跟着身子晃动。/ ……

可以配置**身体IK**。一个完整的例子（第一人称式自拍效果）可参见[锚点](https://tiger-tang.gitbook.io/warudo/assets/anchor)的介绍。
